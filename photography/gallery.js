document.addEventListener("DOMContentLoaded",(()=>{const e=document.getElementById("gallery");let t=document.getElementById("loading"),n=0,o=[],l=0;if(!e)return void console.error("Gallery element not found");if(t||(t=document.createElement("div"),t.className="loading",t.textContent="Loading...",e.parentNode.insertBefore(t,e.nextSibling)),"undefined"==typeof images)return console.error("Image list not loaded. Please check if image-list.js is properly loaded."),void(t.textContent="Error loading images. Please refresh the page.");console.log("Images array loaded:",images.length,"images found"),o=function(e){const t=[...e];for(let e=t.length-1;e>0;e--){const n=Math.floor(Math.random()*(e+1));[t[e],t[n]]=[t[n],t[e]]}return t}(images),console.log("Images shuffled:",o.length,"images");let a=0,s=!1;function i(e,t){const a=document.createElement("div");a.className="gallery-item",a.style.setProperty("--stagger-delay",40*t+"ms");const s=document.createElement("img");return s.loading="lazy",s.decoding="async",s.src=e.src,s.alt=e.alt,console.log("Creating gallery item:",e.src),s.onerror=()=>{console.error(`Failed to load image: ${e.src}`),a.classList.add("error"),a.innerHTML='<div class="error-message">Failed to load image</div>',d()},s.onload=()=>{console.log(`Successfully loaded image: ${e.src}`),a.classList.add("loaded"),l++,d()},a.addEventListener("click",(()=>{!function(e,t){const l=document.createElement("div");l.className="fullscreen-view";const a=document.createElement("div");a.className="fullscreen-content";const s=document.createElement("img");s.src=e,s.alt=t;const i=document.createElement("button");i.className="close-button",i.innerHTML="&times;",i.onclick=()=>{document.body.removeChild(l)};const d=document.createElement("button");d.className="nav-button prev-button",d.innerHTML="&lt;",d.onclick=e=>{e.stopPropagation(),c(-1,s)};const r=document.createElement("button");r.className="nav-button next-button",r.innerHTML="&gt;",r.onclick=e=>{e.stopPropagation(),c(1,s)},a.appendChild(s),a.appendChild(i),a.appendChild(d),a.appendChild(r),l.appendChild(a),document.body.appendChild(l),l.addEventListener("click",(e=>{e.target===l&&document.body.removeChild(l)})),n=o.findIndex((t=>t.fullsize===e))}(e.fullsize,e.alt)})),a.appendChild(s),a}function d(){l>=o.length&&(console.log("All images loaded, hiding loading indicator"),t.style.display="none")}function c(e,t){const l=(n+e+o.length)%o.length,a=o[l];n=l,t.src=a.fullsize,t.alt=a.alt}const r=new IntersectionObserver((e=>{e.forEach((e=>{e.isIntersecting&&(e.target.classList.add("visible"),r.unobserve(e.target))}))}),{threshold:.1,rootMargin:"200px"});function g(){if(s)return;s=!0;const n=a,l=Math.min(a+20,o.length);console.log(`Loading batch ${n} to ${l}`),0===n&&(console.log("First batch starting, hiding loading indicator"),setTimeout((()=>{t&&(t.style.display="none",t.style.visibility="hidden",t.style.opacity="0")}),100));for(let t=n;t<l;t++){const n=i(o[t],t);e.appendChild(n),r.observe(n)}a=l,s=!1,a>=o.length&&(console.log("All batches loaded"),window.removeEventListener("scroll",m))}function m(){window.innerHeight+window.scrollY>document.body.offsetHeight-600&&g()}g(),window.addEventListener("scroll",m)}));